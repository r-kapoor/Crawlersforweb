var routesModule=angular.module("tripdetails.routes.app",["ui.bootstrap","pageslide-directive","ngDraggable","ngJScrollPane"]);routesModule.controller("routesController",["$scope","$rootScope",function(a,b){}]),routesModule.controller("shabariController",["$scope","$rootScope",function(a,b){a.isLoaderShown=!0,b.$on("dataLoaded",function(b,c){a.isLoaderShown=!1}),b.$on("gettingData",function(b,c){a.isLoaderShown=!0})}]),routesModule.controller("sanjayaController",["$scope","$rootScope","$window","orderedCities",function(a,b,c,d){"use strict";function e(){for(var a=0;a<h.length;a++)h[a].setMap(null);for(h=[],a=0;a<g.length;a++)g[a].setMap(null);g=[]}a.zoomConstants={COUNTRY:5,CITY:12},a.centerPosition={Latitude:25.4411179,Longitude:78.5622883};var f,g=[],h=[],i=[];a.map=null,a.zoom=a.zoomConstants.COUNTRY,a.initializeMap=function(){function b(){var b=document.getElementById("map-canvas"),c={center:new google.maps.LatLng(a.centerPosition.Latitude,a.centerPosition.Longitude),zoom:a.zoom,mapTypeId:google.maps.MapTypeId.ROADMAP};console.log("Map Initialized"),a.map=new google.maps.Map(b,c),console.log("Map Initialized"),console.log("Map Initialized"),console.log("Map Initialized")}console.log("Hello World"),angular.element(window).ready(function(){b()}),google.maps.event.addDomListener(window,"resize",function(){var b=a.map.getCenter();google.maps.event.trigger(a.map,"resize"),a.map.setCenter(b)})},a.initializeMap(),a.addMarker=function(b,c){console.log("addMarker");var d=new google.maps.Marker({position:new google.maps.LatLng(b.Latitude,b.Longitude),map:a.map,icon:"http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld="+c+"|FF0000|000000"}),e=new google.maps.InfoWindow({content:b.CityName,map:a.map});e.close(),google.maps.event.addListener(d,"mouseover",function(){e.open(a.map,this)}),google.maps.event.addListener(d,"mouseout",function(){e.close()}),g.push(d),h.push(e)},a.showRoute=function(b,c,d){var e=new google.maps.DirectionsService,g={origin:new google.maps.LatLng(b.Latitude,b.Longitude),destination:new google.maps.LatLng(c.Latitude,c.Longitude),waypoints:d,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC};e.route(g,function(b,c){c==google.maps.DirectionsStatus.OK&&(k(),f=new google.maps.DirectionsRenderer({suppressMarkers:!0,map:a.map,directions:b}))})};var j={path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW};a.showPath=function(b,c){var d;d=c?new google.maps.Polyline({path:google.maps.geometry.encoding.decodePath(b),icons:[{icon:j,offset:"70%",repeat:"0"}],map:a.map}):new google.maps.Polyline({path:google.maps.geometry.encoding.decodePath(b),map:a.map}),i.push(d)},a.showFlightPath=function(b,c,d){var e;e=d?new google.maps.Polyline({path:[new google.maps.LatLng(b.Latitude,b.Longitude),new google.maps.LatLng(c.Latitude,c.Longitude)],icons:[{icon:j,offset:"70%",repeat:"0"}],map:a.map}):new google.maps.Polyline({path:[new google.maps.LatLng(b.Latitude,b.Longitude),new google.maps.LatLng(c.Latitude,c.Longitude)],map:a.map}),i.push(e)};var k=function(){(void 0!=f||null!=f)&&(f.setMap(null),f=null)},l=function(){for(var a=0;a<i.length;a++)i[a].setMap(null),i[a]=null;i=[]};b.$on("plotCities",function(b,c){e();var f=d.getOriginCity();a.addMarker(f,"A");for(var g=d.getOrderedDestinationCities(),h=[],i=0;i<g.length;i++)a.addMarker(g[i],String.fromCharCode("A".charCodeAt()+i+1)),h.push({location:new google.maps.LatLng(g[i].Latitude,g[i].Longitude),stopover:!0});a.showRoute(f,f,h)}),b.$on("plotMarkers",function(b,c){console.log("plotMarkers called"),e();var d=c.origin,f=c.destination;a.addMarker(d,"A"),a.addMarker(f,String.fromCharCode("A".charCodeAt()+1))}),b.$on("showSegment",function(b,c){console.log("In show segment:"+JSON.stringify(c));var d=!1;1==c.isMajor&&(d=!0),void 0!=c.path?a.showPath(c.path,d):a.showFlightPath(c.sAirport,c.tAirport,d)}),b.$on("showTravelPanel",function(){k()}),b.$on("removeSegments",function(){l()})}]),routesModule.directive("postRepeat",["$timeout",function(a){return function(b,c,d,e){console.log("testing...."),console.log("element:"+d["class"]),b.$last&&(a(function(){"panel-travel"==d["class"]&&(console.log("in panel-travel"),console.log("scrollHeightTravel:"+$("#transcludeTravelPanel")[0].scrollHeight),b.$emit("initialize-pane","travelPanel"))},10),a(function(){"panel-travelMode"==d["class"]&&(console.log("in panel-travelMode"),console.log("scrollHeightTravelModes:"+$("#transcludeTravelModesPanel").get(0).scrollHeight),b.$emit("initialize-pane","travelModesPanel"))},1e3),a(function(){"panel-trainMode"==d["class"]&&(console.log("in panel-trainMode"),console.log("scrollHeightTrainMode:"+$("#transcludeTrainPanel").get(0).scrollHeight),b.$emit("initialize-pane","trainPanel"))},1e3),a(function(){"panel-flightMode"==d["class"]&&(console.log("in panel-flightMode"),console.log("scrollHeightFlightMode:"+$("#transcludeFlightPanel").get(0).scrollHeight),b.$emit("initialize-pane","flightPanel"))},1e3))}}]),routesModule.controller("sarthiController",["$scope","$rootScope","$http","$q","$location","orderedCities","$timeout",function(a,b,c,d,e,f,g){function h(){g(function(){a.isTravelPanelOpen=!0,console.log("function timedout:"+a.isTravelPanelOpen)},400)}function i(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function j(d,e,f){var g="/showRoutes?"+d+"&"+e+"&"+f[1];c.get(g).success(function(c,d){b.$emit("dataLoaded"),a.isTravelPanelDataHidden=!1,void 0!=c.tripNotPossible&&1==c.tripNotPossible?console.log("Page NOT FOUND"):(y=c.dateSet,null==c.withoutTaxiRome2rioData?(v=c.withTaxiRome2rioData,w=null):null==c.withTaxiRome2rioData?(v=c.withoutTaxiRome2rioData,w=null):1==c.withoutTaxiRome2rioData.isMajorDefault?(v=c.withoutTaxiRome2rioData,w=c.withTaxiRome2rioData):(v=c.withTaxiRome2rioData,w=c.withoutTaxiRome2rioData),k(v),l(),m(c.userTotalbudget),a.isBudgetPanelOpen=!0,B=c)})}function k(b){for(var c=b.rome2RioData,d=null,e=0;e<c.length;e++){d=c[e];for(var f=0;f<d.routes.length;f++){for(var g=d.routes[f],h=0,i=0;i<g.segments.length;i++){var j=g.segments[i];1==j.isMajor&&(j.majorIndex=h,h++)}g.majorCount=h-1,void 0!=g.isDefault&&1==g.isDefault&&(d.defaultRoute=g,d.defaultRouteIndex=f)}}a.legs=b.rome2RioData}function l(){var c=i("dsts").split(";"),d=i("o");if(1==c.length){d=JSON.parse(d),c=JSON.parse(c);var e={origin:d,destination:c};b.$emit("plotMarkers",e)}b.$emit("removeSegments");for(var f in a.legs)for(var g in a.legs[f].defaultRoute.segments){var h=a.legs[f].defaultRoute.segments[g];b.$emit("showSegment",h)}}function m(b){a.totalBudget=b,n()}function n(){for(var c=0,d=0,e=0,f=0,g=null,h=!1,i=!1,j=null,k=0;k<a.legs.length;k++)for(var l=a.legs[k].defaultRoute.segments,m=0;m<l.length;m++){if(1==l[m].isMajor){c+=parseInt(l[m].indicativePrice.price,10),("train"==l[m].kind||"bus"==l[m].kind)&&(d+=300),l[m].startTime=new Date(l[m].startTime);var n=l[m].startTime.getTime(),o=new Date(l[m].endTime).getTime();e>n&&(h=!0,g=a.legs[k].defaultRoute.stops[m].name),console.log("endTime:"+e+",startTime:"+n),e=o,0==l[m].majorIndex&&A>(n-f)/36e5&&(i=!0,j=a.legs[k].places[0].name),l[m].majorIndex==a.legs[k].defaultRoute.majorCount&&(f=o)}else d+=parseInt(l[m].indicativePrice.price,10);console.log("major budget:"+c),console.log("minor budget:"+d)}a.travelBudget=c,a.minorBudget=d,a.travelBudget+a.minorBudget>a.totalBudget*z?a.travelBudget+a.minorBudget>a.totalBudget?b.$emit("showRecommendation","budgetOutOfLimit"):b.$emit("showRecommendation","budgetExceeds"):b.$emit("hideRecommendation","budget"),console.log("overlapCity:"+g),h?b.$emit("showRecommendation","timeOverlap",g):i?b.$emit("showRecommendation","timeExceeds",j):b.$emit("hideRecommendation","time")}function o(){var b=a.currentRoute;if(b.majorCount>0)for(var c=b.segments,d=0;d<c.length;d++)if(1==c[d].isMajor&&(void 0==c[d].startTime||null==c[d].startTime))return!1;return!0}function p(){for(var b in a.currentLeg.routes)if(a.currentRouteIndex!=b&&void 0!=a.currentLeg.routes[b].isDefault&&1==a.currentLeg.routes[b].isDefault){a.currentLeg.routes[b].isDefault=0;var c=a.currentLeg.routes[b].segments;for(var d in c){if(void 0!=c[d].kind&&1==c[d].isMajor&&"flight"==c[d].kind){c[d].startTime=null,c[d].endTime=null;for(var e in c[d].flightData){var f=c[d].flightData[e];void 0!=f.isFinal&&1==f.isFinal&&(f.isFinal=0)}}if(void 0!=c[d].kind&&1==c[d].isMajor&&"train"==c[d].kind){c[d].startTime=null,c[d].endTime=null;for(var g in c[d].trainData){var h=c[d].trainData[g];void 0!=h.isFinal&&1==h.isFinal&&(h.isFinal=0)}}if(void 0!=c[d].kind&&1==c[d].isMajor&&"bus"==c[d].kind){c[d].startTime=null,c[d].endTime=null;for(var i in c[d].busData){var j=c[d].busData[i];void 0!=j.isFinal&&1==j.isFinal&&(j.isFinal=0)}}void 0==c[d].kind||1!=c[d].isMajor||"taxi"!=c[d].subkind&&"car"!=c[d].subkind||(c[d].startTime=null,c[d].endTime=null)}}}function q(a,b,c,d){var e=parseInt(a.split(":")[0],10),f=parseInt(a.split(":")[1],10),g=parseInt(b.split(":")[0],10),h=parseInt(b.split(":")[1],10),i=f+60*e,j=h+60*g;console.log("startHours:"+e+",startMins:"+f+",endHours:"+g+",startTimeMins:"+i+",endTimeInMIns:"+j);var k=0;return k=c==d?j-i:24*(d-c-1)*60+j+(1440-i)}function r(a,b){return new Date(a.getTime()+6e4*b)}function s(b){a.cabDetailToggle=[];for(var c in b){var d={open:void 0!=b[c].isFinal&&1==b[c].isFinal};a.cabDetailToggle.push(d)}}function t(b,c){function d(a,b){return a=new Date(a),b=new Date(b),a.getTime()-b.getTime()}a.vehicleDate=[];for(var e=0;e<b.length;e++){var f;b[e].dateLimits.length>1?(b[e].dateLimits.sort(d),f=void 0!=b[e].isFinal&&1==b[e].isFinal?{dt:c,opened:!1,disabled:!1,minDate:b[e].dateLimits[0],maxDate:b[e].dateLimits[b[e].dateLimits.length-1]}:{dt:null,opened:!1,disabled:!1,minDate:b[e].dateLimits[0],maxDate:b[e].dateLimits[b[e].dateLimits.length-1]}):f=1==b[e].dateLimits.length?{dt:b[e].dateLimits[0],opened:!1,disabled:!0,minDate:b[e].dateLimits[0],maxDate:b[e].dateLimits[0]}:{dt:null,opened:!1,disabled:!1,minDate:null,maxDate:null},a.vehicleDate.push(f)}}function u(b){var c=new Date(y.dateStart[a.currentLegIndex]),d=new Date(y.dateEnd[a.currentLegIndex]),e=null,f=!1;c.setHours(0,0,0,0),d.setHours(0,0,0,0),d.getTime()-c.getTime()==0&&(f=!0),void 0!=a.currentRoute.isDefault&&1==a.currentRoute.isDefault&&(e=b),a.cabDate={dt:e,opened:!1,disabled:f,minDate:c,maxDate:d}}a.isTravelPanelOpen=!1,a.isTravelModesPanelOpen=!1,a.isTripPanelSetCollapsed=!1,a.isModeDetailsPanelOpen=!1,a.isTravelPanelDataHidden=!0,a.cities=[],a.legs=[],a.currentLeg=null,a.currentLegIndex=-1,a.routes=[],a.trains=[],a.flights=[],a.buses=[],a.isTrainClicked=!1,a.isFlightClicked=!1,a.isBusClicked=!1,a.isCabClicked=!1,a.isDriveClicked=!1,a.isCabOperatorClicked=!1,a.cabDetails=[],a.currentSegment=null,a.currentRoute=null,a.currentRouteIndex=-1,a.cabDetailToggle=[],a.cabDate=null,a.isBudgetPanelOpen=!1,a.travelBudgetText="Travel Expenses",a.totalBudgetText="Your Budget",a.minorBudgetText="Minor Travel Expenses",a.totalBudget=0,a.travelBudget=0,a.minorBudget=0,a.isTravelPanelDisable=!1,a.altTrip=!0,a.segmentHoverClass="segment-hover";var v=null,w=null,x=!1,y=null,z=.7,A=4,B=null,C=6e4,D=60*C;a.pageSlide=function(){a.checked1=!a.checked1,a.checked2=!a.checked2},a.showModes=function(){console.log("in show modes"),a.checked1=!0},a.test=function(){console.log("in test function"),a.checked1&&(a.checked1=!1)},a.openTravelModesPanel=function(b,c,d){a.isModeDetailsPanelOpen&&(a.isModeDetailsPanelOpen=!1),a.isTravelModesPanelOpen=!a.isTravelModesPanelOpen,a.currentLeg=b,a.currentLegIndex=d,console.log("currentLegIndex:"+d),a.routes=b.routes,c.stopPropagation()},a.openModeDetailsPanel=function(b,c,d,e,f){a.currentSegment=b,a.currentRoute=c,a.currentRouteIndex=d,a.isTrainClicked=!1,a.isFlightClicked=!1,a.isBusClicked=!1,a.isCabOperatorClicked=!1,a.isCabClicked=!1,a.isDriveClicked=!1,a.isTaxiClicked=!1,a.isModeDetailsPanelOpen=!a.isModeDetailsPanelOpen,"train"==b.kind?(t(b.trainData,b.startTime),a.trains=b.trainData,a.isTrainClicked=!0):"flight"==b.kind?(t(b.flightData,b.startTime),a.flights=b.flightData,g(function(){a.isFlightClicked=!0},500)):"bus"==b.kind?(t(b.busData,b.startTime),a.buses=b.busData,g(function(){a.isBusClicked=!0},500)):"car"==b.kind&&(void 0!=b.subkind&&"cab"==b.subkind&&void 0!=f&&("cabOperator"==f?(a.isTravelModesPanelOpen=!1,a.isCabOperatorClicked=!0,a.cabDetails=b.CabDetails,s(b.CabDetails)):"cabTimings"==f&&(a.isCabClicked=!0,u(b.startTime))),"taxi"==b.subkind&&(a.isTaxiClicked=!0,"cabTimings"==f&&u(b.startTime)),"car"==b.subkind&&(a.isDriveClicked=!0,"cabTimings"==f&&u(b.startTime))),e.stopPropagation()},a.getSourceCityFromLeg=function(){return null==a.currentLeg?null:a.currentLeg.places[0].name},a.getDestinationCityFromLeg=function(){return null==a.currentLeg?null:a.currentLeg.places[1].name},angular.element(window).ready(function(){var b=e.absUrl(),c=b.split("?"),d=i("dsts").split(";"),f=i("o"),g="",h="";c.length>1&&1==d.length&&(a.isTravelPanelOpen=!0,f=JSON.parse(f),d=JSON.parse(d),g+="cities="+f.CityName+","+d.CityName+","+f.CityName,h+="cityIDs="+f.CityID+","+d.CityID+","+f.CityName,j(g,h,c))}),b.$on("showTravelPanel",function(a,c){h(),b.$emit("gettingData");var d=f.getOrderedDestinationCities(),e=f.getOriginCity(),g=f.getPathArray(),i="cities=",k="cityIDs=";i+=e.CityName+",",k+=e.CityID+",";for(var l=0;l<d.length;l++)i+=d[l].CityName+",",k+=d[l].CityID+",";i+=e.CityName,k+=e.CityID,j(i,k,g)}),a.getSourceCityName=function(b){var c=a.legs[b];return c.places[0].name},a.getDestinationCityName=function(b){var c=a.legs[b];return c.places[1].name},a.getDefaultRoute=function(b){for(var c=a.legs[b],d=0;d<c.routes.length;d++)if(void 0!=c.routes[d].isDefault&&1==c.routes[d].isDefault)return c.routes[d]},a.getModeClass=function(a,b){return void 0!=a.isDefault&&1==a.isDefault?a.majorCount>0&&1==b.isMajor&&(void 0==b.startTime||null==b.startTime)?"segment-warning":"default-route":""},a.onTaxiDetailsLeave=function(){a.segmentHoverClass="segment-hover"},a.onTaxiDetailsHover=function(){a.segmentHoverClass=""},a.getIconClass=function(a){return void 0!=a.isDefault&&1==a.isDefault?"icon-default icon-hover":""},a.getModeIcon=function(a){return"flight"==a.kind?"glyphicons-39-airplane":"car"==a.kind?"glyphicons-6-car":"train"==a.kind?"glyphicons-15-train":"bus"==a.kind?"glyphicons-32-bus":"glyphicon-asterisk"},a.getStopName=function(a,b){return b.stops[a+1].name},a.getDateFormatted=function(a){return a.startTime},a.getDuration=function(a){var b=parseInt(a.duration,10),c=parseInt(b/60,10),d=b%60,e="";return c>0&&(e+=c+" hrs "),d>0&&(e+=d+" min"),e},a.getPrice=function(a){return a.indicativePrice.price},a.closeOtherPanels=function(b){1==b?(a.isTravelModesPanelOpen&&(a.isTravelModesPanelOpen=!1),a.isModeDetailsPanelOpen&&(a.isModeDetailsPanelOpen=!1)):2==b&&a.isModeDetailsPanelOpen&&(a.isModeDetailsPanelOpen=!1)},a.getTransparentClass=function(b){return 1==b?a.isModeDetailsPanelOpen||a.isTravelModesPanelOpen?"panel-transparent":"":2==b?a.isModeDetailsPanelOpen?"panel-transparent":"":void 0},a.isShowOtherTrip=function(){return null!=w?!0:!1},a.showOtherTrip=function(){a.isTripPanelSetCollapsed=!0,x=!x,g(function(){var b=w;w=v,v=b,k(v),a.isTripPanelSetCollapsed=!1,l(),n()},1e3)},a.getOtherTripText=function(){return console.log("getOtherTripText Called"),console.log("isOtherTripClicked"+x),void 0!=v.isCabTrip&&1==v.isCabTrip?x?(a.altTrip=!1,"Back To Multi-Mode Travel"):(a.altTrip=!0,"Check Out Multi-Mode Travel For This Trip"):x?(a.altTrip=!1,"Back To MultiCityTaxi Travel"):(a.altTrip=!0,"Check Out MultiCityTaxi Travel For This Trip")},a.isSegmentShown=function(a,b){return a.majorIndex==b.defaultRoute.majorCount?!0:!0},a.isViaShown=function(a){return"car"==a.kind&&void 0!=a.subkind&&"cab"==a.subkind?void 0!=a.endCabTrip&&1==a.endCabTrip?!0:!1:!0},a.isPriceShown=function(a){return"car"==a.kind&&void 0!=a.subkind&&"cab"==a.subkind?!1:!0},a.isPanelFooterShown=function(a){return"car"==a.kind&&void 0!=a.subkind&&"cab"==a.subkind&&void 0!=a.endCabTrip&&1==a.endCabTrip?!0:!1},a.getStartCityForTaxi=function(a){return a.carLegDetails[0]},a.getEndCityForTaxi=function(a){return a.endCity},a.getPanelClass=function(a){return void 0!=a.isFinal&&1==a.isFinal?"panel-success":"panel-info"},a.addToTrip=function(b,c,d){var e=!1;if(null==a.vehicleDate[c].dt)d.preventDefault(),d.stopPropagation(),a.vehicleDate[c].opened=!0;else{var f=new Date(a.vehicleDate[c].dt),g=parseInt(b.OriginDepartureTime.split(":")[0],10),h=parseInt(b.OriginDepartureTime.split(":")[1],10);f.setHours(g),f.setMinutes(h);var i,j=q(b.OriginDepartureTime,b.DestArrivalTime,b.OriginDay,b.DestDay);if(a.isTrainClicked?i=a.trains:a.isFlightClicked?i=a.flights:a.isCabClicked&&(i=a.buses),void 0==b.isFinal||1!=b.isFinal){for(var k in i)console.log("vehicle:"+JSON.stringify(k)),void 0!=i[k].isFinal&&1==i[k].isFinal&&(i[k].isFinal=0);p(),b.isFinal=1,void 0!=b.fare&&(a.currentRoute.indicativePrice.price=b.fare),a.currentLeg.defaultRoute=a.currentRoute,a.currentRoute.isDefault=1}a.currentSegment.startTime=f,a.currentSegment.endTime=r(f,j),a.currentSegment.duration=j,void 0!=b.fare&&(a.currentSegment.indicativePrice.price=b.fare),b.date=f,e=o(),e?(a.isTravelModesPanelOpen=!1,a.isModeDetailsPanelOpen=!1,a.isTravelPanelDisable=!1):(a.isModeDetailsPanelOpen=!1,a.isTravelPanelDisable=!0)}e&&(l(),n())},a.addCabToTrip=function(b){var c=a.cabDate.dt;if(null==c||void 0==c)a.openCabDate(b);else{p(),a.currentLeg.defaultRoute=a.currentRoute,a.currentRoute.isDefault=1,a.currentSegment.startTime=c,a.currentSegment.endTime=r(c,a.currentSegment.duration),console.log(a.currentSegment.endTime);var d=o();d?(a.isTravelModesPanelOpen=!1,a.isModeDetailsPanelOpen=!1,a.isTravelPanelDisable=!1,l(),n()):(a.isModeDetailsPanelOpen=!1,a.isTravelPanelDisable=!0)}},a.getAddButtonClass=function(a){return void 0!=a&&void 0!=a.isFinal&&1==a.isFinal?"btn-success":"btn-primary"},a.getAddButtonText=function(a){return void 0!=a.isFinal&&1==a.isFinal?"Added":"Add"},a.getAddButtonClassForTaxiOrDrive=function(){return 1==a.currentRoute.isDefault?"btn-success":"btn-primary"},a.getAddButtonTextForTaxiOrDrive=function(){return 1==a.currentRoute.isDefault?"Added":"Add"},a.getNthDay=function(a){var b=a.DestDay;return"1"==b?"Same Day":"2"==b?"Next Day":"3rd Day"},a.getRouteClass=function(a){return"car"==a.kind&&void 0!=a.subkind&&"cab"==a.subkind?"cab-route":""},a.getAccordionHeadingClass=function(a){return void 0!=a.isFinal&&1==a.isFinal?"final-cab-segment":""},a.changeCabOperator=function(b,c,d){d.preventDefault(),d.stopPropagation();for(var e in a.cabDetails)if(void 0!=a.cabDetails[e].isFinal&&1==a.cabDetails[e].isFinal){a.cabDetails[e].isFinal=0;for(var f in a.cabDetails[e].OperatorPrices){var g=a.cabDetails[e].OperatorPrices[f];void 0!=g.isFinal&&1==g.isFinal&&(g.isFinal=0)}}b.isFinal=1,c.isFinal=1,a.currentSegment.indicativePrice.price=c.ActualCabPrice,a.isTravelModesPanelOpen=!1,a.isModeDetailsPanelOpen=!1,n()},a.openCabDate=function(b){b.preventDefault(),b.stopPropagation(),a.cabDate.opened=!0},a.vehicleDate=[],a.toggleMin=function(){a.minDate=a.minDate?null:new Date},a.toggleMin(),a.open=function(b,c){b.preventDefault(),b.stopPropagation();for(var d=0;d<a.vehicleDate.length;d++)d==c?a.vehicleDate[d].opened=!0:a.vehicleDate[d].opened=!1},a.dateOptions={formatYear:"yy",startingDay:1},a.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],a.format=a.formats[1],a.disabled=function(a,b,c){var d=a.getDay()+1+"";if("0"==c.DaysOfTravel)return!1;var e=-1!=c.DaysOfTravel.indexOf(d);return"day"===b&&!e},a.getHours=function(){return null==a.cabDate.dt?"00":a.cabDate.dt.getHours()<10?"0"+a.cabDate.dt.getHours():a.cabDate.dt.getHours()},a.getMins=function(){return null==a.cabDate.dt?"00":a.cabDate.dt.getMinutes()<10?"0"+a.cabDate.dt.getMinutes():a.cabDate.dt.getMinutes()},a.incrementHours=function(b){if(null==a.cabDate.dt)a.openCabDate(b);else{var c=new Date(a.cabDate.dt.getTime()+1*D);c<=new Date(a.cabDate.maxDate.getTime()+23*D)&&(a.cabDate.dt=c)}},a.incrementMinutes=function(b){if(null==a.cabDate.dt)a.openCabDate(b);else{var c=new Date(a.cabDate.dt.getTime()+9e5);c<=new Date(a.cabDate.maxDate.getTime()+23*D+27e5)&&(a.cabDate.dt=c)}},a.decrementHours=function(b){if(null==a.cabDate.dt)a.openCabDate(b);else{var c=new Date(a.cabDate.dt.getTime()-1*D);c>=a.cabDate.minDate&&(a.cabDate.dt=c)}},a.decrementMinutes=function(b){if(null==a.cabDate.dt)a.openCabDate(b);else{var c=new Date(a.cabDate.dt.getTime()-9e5);c>=a.cabDate.minDate&&(a.cabDate.dt=c)}},b.$on("submitTravel",function(b,c){console.log("submitTravel"),console.log(v),null!=v&&(v.isMajorDefault=1),null!=w&&(w.isMajorDefault=0),null!=B.withTaxiRome2rioData&&1==B.withTaxiRome2rioData.isMajorDefault?delete B.withoutTaxiRome2rioData:delete B.withTaxiRome2rioData,B.travelBudget=a.travelBudget,B.minorTravelBudget=a.minorBudget,B=JSON.stringify(B);var d=angular.element("<form>");d.attr("action","/showPlacesAndHotels"),d.attr("method","POST");var e=angular.element("<input type='hidden'/>");e.attr("name","travelData"),e.attr("value",B),d.append(e);var f=angular.element(document.querySelectorAll("body"));f.append(d),d.submit()})}]),routesModule.controller("suryaController",["$scope","$rootScope","$http","$q","$location","orderedCities",function(a,b,c,d,e,f){function g(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}a.reorderPanel=!1,a.reorderList=!0,a.draggableObjects=[];var h=[],i=1.4;b.$on("orderReceived",function(c,d){a.draggableObjects=f.getOrderedDestinationCities(),a.originCity=f.getOriginCity(),a.reorderList=!1,b.$emit("plotCities"),b.$emit("dataLoaded")}),a.onDropComplete=function(c,d,e){var g=a.draggableObjects[c],h=a.draggableObjects.indexOf(d);a.draggableObjects[c]=d,a.draggableObjects[h]=g;var j=0,k=a.originCity.CityID,l=f.getWeightArray(),m=f.getCityIDs(),n=a.draggableObjects.length;j+=l[m.indexOf(k)][m.indexOf(a.draggableObjects[0].CityID)];for(var o=1;n>o;o++){var p=a.draggableObjects[o-1].CityID,q=a.draggableObjects[o].CityID,r=m.indexOf(p),s=m.indexOf(q);j+=l[r][s]}j+=l[m.indexOf(a.draggableObjects[n-1].CityID)][m.indexOf(k)],f.getMinimumWeight()*i<j?b.$emit("showRecommendation","inEfficientOrder"):b.$emit("hideRecommendation","order"),b.$emit("plotCities")},b.$on("showRoutes",function(c,d){a.reorderPanel=!1,b.$emit("showTravelPanel")}),angular.element(window).ready(function(){var d=e.absUrl();h=d.split("?");var i=g("dsts").split(";");h.length>1&&i.length>1?(a.reorderPanel=!0,c.get("/getOptimizeOrder?"+h[1]).success(function(a,c){f.setOrderedDestinationCities(a.trip),f.setOriginCity(a.origin),f.setWeightArray(a.weight),f.setMinimumWeight(a.minWeight),f.setPathArray(h),f.setCityIDs(a.cityIDs),b.$emit("orderReceived")})):h.length>1&&1==i.length||console.log("Page NOT FOUND")})}]);var routesModule;routesModule.controller("indraController",["$scope","$rootScope","$location",function(a,b,c){"use strict";function d(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}a.isHomeShown=!1,a.isHowItWorksShown=!1,a.isLogInShown=!1,a.isSaveShown=!0,a.isBudgetPercentShown=!1,a.isSignUpShown=!1,a.saveText="CONTINUE",a.budgetPercent=0,a.submitFunctionName="";var e=!0;a.submitPage=function(){var a=c.absUrl(),f=a.split("?"),g=d("dsts").split(";");f.length>1&&(1==g.length?b.$emit("submitTravel"):g.length>1&&(console.log("length>1"),e?(console.log("reorder true"),b.$emit("showRoutes"),e=!1):(console.log("reorder false"),b.$emit("submitTravel"))))},a.getSubmitFunction=function(){return a.submitFunctionName}}]),routesModule.service("orderedCities",function(){var a=[],b=null,c=[],d=0,e=[],f=[];return{getOrderedDestinationCities:function(){return a},getOriginCity:function(){return b},getWeightArray:function(){return c},getMinimumWeight:function(){return d},getPathArray:function(){return e},getCityIDs:function(){return f},setOrderedDestinationCities:function(b){a=b},setOriginCity:function(a){b=a},setWeightArray:function(a){c=a},setMinimumWeight:function(a){d=a},setPathArray:function(a){e=a},setCityIDs:function(a){f=a}}}),routesModule.filter("titleCase",function(){return function(a){return a=a||"",a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}}),routesModule.filter("formatTime",function(){return function(a){return 8!=a.length?a:a.substring(0,5)}});var pageslideDirective=angular.module("pageslide-directive",[]);pageslideDirective.directive("pageslide",[function(){return{restrict:"EA",replace:!1,transclude:!1,scope:{psOpen:"=?",psAutoClose:"=?"},link:function(a,b,c){function d(b,c){if(b&&0!==b.style.width&&0!==b.style.width)switch(h.style.display="none",c.side){case"right":b.style.width="0px";break;case"left":b.style.width="0px";break;case"top":b.style.height="0px";break;case"bottom":b.style.height="0px"}a.psOpen=!1}function e(a,b){if(0!==a.style.width&&0!==a.style.width){switch(b.side){case"right":a.style.width=b.size;break;case"left":a.style.width=b.size;break;case"top":a.style.height=b.size;break;case"bottom":a.style.height=b.size}setTimeout(function(){h.style.display="block"},1e3*b.speed)}}function f(a){var b={};return a&&"[object Function]"===b.toString.call(a)}var g={};g.side=c.psSide||"right",g.speed=c.psSpeed||"0.5",g.size=c.psSize||"300px",g.zindex=c.psZindex||1e3,g.className=c.psClass||"ng-pageslide";var h=null,i=null;if(!c.href&&b.children()&&b.children().length)h=b.children()[0];else{var j=(c.href||c.psTarget).substr(1);h=document.getElementById(j),i=document.getElementById("pageslide-target-"+j),i||(i=document.createElement("div"),i.id="pageslide-target-"+j)}if(!h)throw new Error("You have to elements inside the <pageslide> or you have not specified a target href");switch(i=i||document.createElement("div"),i.className=g.className,i.style.transitionDuration=g.speed+"s",i.style.webkitTransitionDuration=g.speed+"s",i.style.zIndex=g.zindex,i.style.position="fixed",i.style.width=0,i.style.height=0,i.style.transitionProperty="width, height",g.side){case"right":i.style.height=c.psCustomHeight||"100%",i.style.top=c.psCustomTop||"0px",i.style.bottom=c.psCustomBottom||"0px",i.style.right=c.psCustomRight||"0px";break;case"left":i.style.height=c.psCustomHeight||"100%",i.style.top=c.psCustomTop||"71px",i.style.bottom=c.psCustomBottom||"0px",i.style.left=c.psCustomLeft||"0px";break;case"top":i.style.width=c.psCustomWidth||"100%",i.style.left=c.psCustomLeft||"0px",i.style.top=c.psCustomTop||"0px",i.style.right=c.psCustomRight||"0px";break;case"bottom":i.style.width=c.psCustomWidth||"100%",i.style.bottom=c.psCustomBottom||"0px",i.style.left=c.psCustomLeft||"0px",i.style.right=c.psCustomRight||"0px"}document.body.appendChild(i),i.appendChild(h),c.psSize&&a.$watch(function(){return c.psSize},function(b,c){g.size=b,a.psOpen&&e(i,g)}),a.$watch("psOpen",function(a){a?e(i,g):d(i,g)}),a.psAutoClose&&(a.$on("$locationChangeStart",function(){d(i,g),f(a.psAutoClose)&&a.psAutoClose()}),a.$on("$stateChangeStart",function(){d(i,g),f(a.psAutoClose)&&a.psAutoClose()})),a.$on("$destroy",function(){document.body.removeChild(i)});var k=c.href?document.getElementById(c.href.substr(1)+"-close"):null;b[0].addEventListener?(b[0].addEventListener("click",function(a){a.preventDefault(),e(i,g)}),k&&k.addEventListener("click",function(a){a.preventDefault(),d(i,g)})):(b[0].attachEvent("onclick",function(a){a.returnValue=!1,e(i,g)}),k&&k.attachEvent("onclick",function(a){a.returnValue=!1,d(i,g)}))}}}]),angular.module("ngDraggable",[]).service("ngDraggable",["$window",function(a){var b=function(a){return"undefined"!=typeof a};this.getEventProp=function(a,c,d){return b(a.touches)&&a.touches[0]?a.touches[0][c]:b(a[c])?a[c]:a.originalEvent&&!d?this.getEventProp(a.originalEvent,c,!0):void 0},this.getPrivOffset=function(c){var d={top:0,left:0};return b(c[0].getBoundingClientRect)&&(d=c[0].getBoundingClientRect()),{top:d.top+a.pageYOffset-c[0].clientTop,left:d.left+a.pageXOffset-c[0].clientLeft}}}]).directive("ngDrag",["$rootScope","$parse","$document","$window","ngDraggable",function(a,b,c,d,e){return{restrict:"A",link:function(f,g,h){f.value=h.ngDrag;var i,j,k,l,m,n,o,p=!1,q="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,r="touchstart mousedown",s="touchmove mousemove",t="touchend mouseup",u=f.$id,v=null,w=null,x=!1,y=null,z=b(h.ngDragSuccess)||null,A=function(){g.attr("draggable","false"),B(!0)},B=function(a){a&&(f.$on("$destroy",C),f.$watch(h.ngDrag,E),f.$watch(h.ngCenterAnchor,F),f.$watch(h.ngDragData,D),g.on(r,H),q||"img"!=g[0].nodeName.toLowerCase()||g.on("mousedown",function(){return!1}))},C=function(a){B(!1)},D=function(a,b){v=a},E=function(a,b){x=a},F=function(a,b){angular.isDefined(a)&&(p=a||"true")},G=function(a){return angular.isDefined(angular.element(a.target).attr("ng-click"))||angular.isDefined(angular.element(a.target).attr("ng-dblclick"))||angular.isDefined(angular.element(a.target).attr("ng-cancel-drag"))},H=function(a){x&&(G(a)||(q?(I(),y=setTimeout(function(){I(),J(a)},100),c.on(s,I),c.on(t,I)):J(a)))},I=function(){clearTimeout(y),c.off(s,I),c.off(t,I)},J=function(b){x&&(b.preventDefault(),g.addClass("dragging"),i=e.getPrivOffset(g),w=i,g.centerX=g[0].offsetWidth/2,g.centerY=g[0].offsetHeight/2,j=e.getEventProp(b,"pageX"),k=e.getEventProp(b,"pageY"),n=j-i.left,o=k-i.top,p?(l=j-g.centerX-d.pageXOffset,m=k-g.centerY-d.pageYOffset):(l=j-n-d.pageXOffset,m=k-o-d.pageYOffset),c.on(s,K),c.on(t,L),a.$broadcast("draggable:start",{x:j,y:k,tx:l,ty:m,event:b,element:g,data:v}))},K=function(b){x&&(b.preventDefault(),j=e.getEventProp(b,"pageX"),k=e.getEventProp(b,"pageY"),p?(l=j-g.centerX-w.left,m=k-g.centerY-w.top):(l=j-n-w.left,m=k-o-w.top),O(l,m),a.$broadcast("draggable:move",{x:j,y:k,tx:l,ty:m,event:b,element:g,data:v,uid:u}))},L=function(b){x&&(b.preventDefault(),a.$broadcast("draggable:end",{x:j,y:k,tx:l,ty:m,event:b,element:g,data:v,callback:M,uid:u}),g.removeClass("dragging"),N(),c.off(s,K),c.off(t,L))},M=function(a){z&&f.$apply(function(){z(f,{$data:v,$event:a})})},N=function(){g.css({transform:"","z-index":""})},O=function(a,b){g.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+a+", "+b+", 0, 1)","z-index":99999})};A()}}}]).directive("ngDrop",["$parse","$timeout","$window","ngDraggable",function(a,b,c,d){return{restrict:"A",link:function(c,e,f){c.value=f.ngDrop;var g=c.$id,h=!1,i=a(f.ngDropSuccess),j=a(f.ngDragStart),k=a(f.ngDragStop),l=a(f.ngDragMove),m=a(f.ngOntouch),n=function(){o(!0)},o=function(a){a&&(f.$observe("ngDrop",q),c.$on("$destroy",p),c.$on("draggable:start",r),c.$on("draggable:move",s),c.$on("draggable:end",t))},p=function(a){o(!1)},q=function(a,b){h=c.$eval(a)},r=function(a,d){h&&(u(d.x,d.y,d.element),b(function(){j(c,{$data:d.data,$event:d})}))},s=function(a,d){h&&(u(d.x,d.y,d.element),b(function(){l(c,{$data:d.data,$event:d})}))},t=function(a,d){h&&g!==d.uid&&(u(d.x,d.y,d.element)&&(d.callback&&d.callback(d),b(function(){i(c,{$data:d.data,$event:d})})),b(function(){k(c,{$data:d.data,$event:d})}),v(!1,d.element))},u=function(a,b,c){var d=w(a,b);return v(d,c),d},v=function(a,d){a?(e.addClass("drag-enter"),d.addClass("drag-over"),b(function(){m(c,{$event:"touch"})})):(e.removeClass("drag-enter"),d.removeClass("drag-over"),b(function(){m(c,{$event:"nonTouch"})}))},w=function(a,b){var c=d.getPrivOffset(e);return c.right=c.left+e[0].offsetWidth,c.bottom=c.top+e[0].offsetHeight,a>=c.left&&a<=c.right&&b<=c.bottom&&b>=c.top};n()}}}]).directive("ngDragClone",["$parse","$timeout","ngDraggable",function(a,b,c){return{restrict:"A",link:function(a,b,d){var e,f=!0,g=null;a.clonedData={};var h=function(){e=b.find("img"),b.attr("draggable","false"),e.attr("draggable","false"),n(),i(!0)},i=function(b){b&&(a.$on("draggable:start",k),a.$on("draggable:move",l),a.$on("draggable:end",m),j())},j=function(){e.off("mousedown touchstart touchmove touchend touchcancel",p),
e.on("mousedown touchstart touchmove touchend touchcancel",p)},k=function(d,e,h){f=!0,angular.isDefined(e.data.allowClone)&&(f=e.data.allowClone),f&&(a.$apply(function(){a.clonedData=e.data}),b.css("width",e.element[0].offsetWidth),b.css("height",e.element[0].offsetHeight),o(e.tx,e.ty)),g=c.getPrivOffset(b)},l=function(a,b){f&&(_tx=b.tx+g.left,_ty=b.ty+g.top,o(_tx,_ty))},m=function(a,b){f&&n()},n=function(){b.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})},o=function(a,c){b.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+a+", "+c+", 0, 1)","z-index":99999,visibility:"visible"})},p=function(a){var b=a.originalEvent;return b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.cancelBubble=!0,b.returnValue=!1,!1};h()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(a,b){return{restrict:"A",link:function(a,b,c){var d=function(){b.attr("draggable","false"),e(!0)},e=function(a){a&&b.on("mousedown touchstart touchmove touchend touchcancel",f)},f=function(a){var b=a.originalEvent;return b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.cancelBubble=!0,b.returnValue=!1,!1};d()}}}]).directive("ngCancelDrag",[function(){return{restrict:"A",link:function(a,b,c){b.find("*").attr("ng-cancel-drag","ng-cancel-drag")}}}]);var routesModule;routesModule.controller("balaramaController",["$scope","$rootScope",function(a,b){"use strict";a.alerts=[];var c={budgetExceeds:{kind:"budget",type:"danger",msg:"You may go out of your budget!!"},budgetOutOfLimit:{kind:"budget",type:"danger",msg:"You have Exceeded your budget!!"},timeExceeds:{kind:"time",type:"danger",msg:"You are spending very less time in ?!!"},timeOverlap:{kind:"time",type:"danger",msg:"You are leaving ? before reaching!!"},inEfficientOrder:{kind:"order",type:"",msg:"You are covering too much distance!!"}};a.closeAlert=function(b){a.alerts.splice(b,1)},b.$on("showRecommendation",function(b,e,f){var g=c[e],h=JSON.parse(JSON.stringify(g));d(h.kind),void 0!==f&&(h.msg=h.msg.replace("?",f)),a.alerts.push(h)}),b.$on("hideRecommendation",function(a,b){d(b)});var d=function(b){for(var c in a.alerts)a.alerts[c].kind===b&&a.alerts.splice(c,1)}}]),function(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=0,g=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),g=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(g=0,f=-1*e),void 0!==c.wheelDeltaY&&(g=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(f=-1*c.wheelDeltaX/120),d.unshift(b,e,f,g),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),function(a,b){var c=function(c){return a(c,b)};"function"==typeof define&&define.amd?define(["jquery"],c):"object"==typeof exports?module.exports=c:c(jQuery)}(function(a,b,c){a.fn.jScrollPane=function(d){function e(d,e){function f(b){var e,h,j,l,m,n,q=!1,r=!1;if(Q=b,console.log("elementID"+d.attr("id")),R===c)m=d.scrollTop(),n=d.scrollLeft(),d.css({overflow:"hidden",padding:0}),S=d.innerWidth()+ua,T=d.innerHeight(),console.log("element.innerWidth:"+d.innerWidth()),console.log("paneHeight:"+T),d.width(S),R=a('<div class="jspPane" />').css("padding",ta).append(d.children()),U=a('<div class="jspContainer" />').css({width:S+"px",height:T+"px"}).append(R).appendTo(d);else{if(d.css("width",""),console.log("elem.innerHeight():"+d.innerHeight()),q=Q.stickToBottom&&C(),r=Q.stickToRight&&D(),l=d.innerWidth()+ua!=S||d.outerHeight()!=T,!l&&va==V&&R.outerHeight()==u)return void d.width(S);va=V,R.css("width",""),d.width(S),U.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}V=b.contentWidth?b.contentWidth:R[0].scrollWidth,console.log("transclude:"+a("#transclude")[0].scrollHeight);var s=T;console.log("pane[0].scrollHeight:"+R[0].scrollHeight),R.css("height",s);var t=0;"travelPanel"==d.attr("id")?(t=a("#transcludeTravelPanel")[0].scrollHeight,console.log("withID travelPanel:"+t)):"travelModesPanel"==d.attr("id")?(t=a("#transcludeTravelModesPanel")[0].scrollHeight,console.log("withID travelModesPanel:"+t)):"destinationsPanel"==d.attr("id")?(t=a("#transcludeDestinationsPanel")[0].scrollHeight,console.log("withID transcludeDestinationsPanel:"+t)):(t=a("#transclude")[0].scrollHeight,console.log("other than else:"+t)),t+=21*t/100,"destinationsPanel"==d.attr("id")&&(t=a("#transcludeDestinationsPanel")[0].scrollHeight);var u=t;console.log("contentHeight123:"+u),R.css("overflow",""),X=V/S,Y=u/T,Z=Y>1,$=!1,console.log(S,T,V,u,X,Y,$,Z),$||Z?(d.addClass("jspScrollable"),e=Q.maintainPosition&&(ba||ea),e&&(h=A(),j=B()),g(d),i(),k(u),e&&(y(r?V-S:h,!1),x(q?u-T:j,!1)),H(),E(),N(),Q.enableKeyboardNavigation&&J(),Q.clickOnTrack&&o(),L(),Q.hijackInternalLinks&&M()):(d.removeClass("jspScrollable"),R.css({top:0,left:0,width:U.width()-ua}),F(),I(),K(),p()),Q.autoReinitialise&&!sa?sa=setInterval(function(){f(Q)},Q.autoReinitialiseDelay):!Q.autoReinitialise&&sa&&clearInterval(sa),m&&d.scrollTop(0)&&x(m,!1),n&&d.scrollLeft(0)&&y(n,!1),d.trigger("jsp-initialised",[$||Z]),a(".jspDrag").hide();var v=d.attr("id");a("#"+v).mouseenter(function(){a(".jspDrag."+v).fadeIn("slow")}),a("#"+v).mouseleave(function(){a(".jspDrag."+v).fadeOut("slow")})}function g(b){console.log("isScrollableV:"+Z);var c=b.attr("id");Z&&(console.log("initialiseVerticalScroll"),U.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag '+c+'"/>').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),fa=U.find(">.jspVerticalBar"),ga=fa.find(">.jspTrack"),_=ga.find(">.jspDrag"),Q.showArrows&&(ka=a('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",m(0,-1)).bind("click.jsp",G),la=a('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",m(0,1)).bind("click.jsp",G),Q.arrowScrollOnHover&&(ka.bind("mouseover.jsp",m(0,-1,ka)),la.bind("mouseover.jsp",m(0,1,la))),l(ga,Q.verticalArrowPositions,ka,la)),ia=T,U.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ia-=a(this).outerHeight()}),_.hover(function(){_.addClass("jspHover")},function(){_.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",G),_.addClass("jspActive");var c=b.pageY-_.position().top;return a("html").bind("mousemove.jsp",function(a){r(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",q),!1}),h())}function h(){ga.height(ia+"px"),ba=0,ha=Q.verticalGutter+ga.outerWidth(),R.width(S-ha-ua);try{0===fa.position().left&&R.css("margin-left",ha+"px")}catch(a){}}function i(){$&&(U.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),ma=U.find(">.jspHorizontalBar"),na=ma.find(">.jspTrack"),ca=na.find(">.jspDrag"),Q.showArrows&&(qa=a('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",m(-1,0)).bind("click.jsp",G),ra=a('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",m(1,0)).bind("click.jsp",G),Q.arrowScrollOnHover&&(qa.bind("mouseover.jsp",m(-1,0,qa)),ra.bind("mouseover.jsp",m(1,0,ra))),l(na,Q.horizontalArrowPositions,qa,ra)),ca.hover(function(){ca.addClass("jspHover")},function(){ca.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",G),ca.addClass("jspActive");var c=b.pageX-ca.position().left;return a("html").bind("mousemove.jsp",function(a){t(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",q),!1}),oa=U.innerWidth(),j())}function j(){U.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){oa-=a(this).outerWidth()}),na.width(oa+"px"),ea=0}function k(b){if(console.log("contentofHeight:"+b),$&&Z){var c=na.outerHeight(),d=ga.outerWidth();ia-=c,a(ma).find(">.jspCap:visible,>.jspArrow").each(function(){oa+=a(this).outerWidth()}),oa-=d,T-=d,S-=c,na.parent().append(a('<div class="jspCorner" />').css("width",c+"px")),h(),j()}$&&R.width(U.outerWidth()-ua+"px"),W=b,Y=W/T,$&&(pa=Math.ceil(1/X*oa),pa>Q.horizontalDragMaxWidth?pa=Q.horizontalDragMaxWidth:pa<Q.horizontalDragMinWidth&&(pa=Q.horizontalDragMinWidth),ca.width(pa+"px"),da=oa-pa,u(ea)),Z&&(ja=Math.ceil(1/Y*ia),ja>Q.verticalDragMaxHeight?ja=Q.verticalDragMaxHeight:ja<Q.verticalDragMinHeight&&(ja=Q.verticalDragMinHeight),_.height(ja+"px"),aa=ia-ja,s(ba))}function l(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function m(a,b,c){return function(){return n(a,b,this,c),this.blur(),!1}}function n(b,c,d,e){d=a(d).addClass("jspActive");var f,g,h=!0,i=function(){0!==b&&wa.scrollByX(b*Q.arrowButtonSpeed),0!==c&&wa.scrollByY(c*Q.arrowButtonSpeed),g=setTimeout(i,h?Q.initialDelay:Q.arrowRepeatFreq),h=!1};i(),f=e?"mouseout.jsp":"mouseup.jsp",e=e||a("html"),e.bind(f,function(){d.removeClass("jspActive"),g&&clearTimeout(g),g=null,e.unbind(f)})}function o(){p(),Z&&ga.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageY-f.top-ba,h=!0,i=function(){var a=e.offset(),c=b.pageY-a.top-ja/2,f=T*Q.scrollPagePercent,k=aa*f/(W-T);if(0>g)ba-k>c?wa.scrollByY(-f):r(c);else{if(!(g>0))return void j();c>ba+k?wa.scrollByY(f):r(c)}d=setTimeout(i,h?Q.initialDelay:Q.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}}),$&&na.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageX-f.left-ea,h=!0,i=function(){var a=e.offset(),c=b.pageX-a.left-pa/2,f=S*Q.scrollPagePercent,k=da*f/(V-S);if(0>g)ea-k>c?wa.scrollByX(-f):t(c);else{if(!(g>0))return void j();c>ea+k?wa.scrollByX(f):t(c)}d=setTimeout(i,h?Q.initialDelay:Q.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}})}function p(){na&&na.unbind("mousedown.jsp"),ga&&ga.unbind("mousedown.jsp")}function q(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),_&&_.removeClass("jspActive"),ca&&ca.removeClass("jspActive")}function r(a,b){console.log("isScrollableV:"+Z),Z&&(0>a?a=0:a>aa&&(a=aa),b===c&&(b=Q.animateScroll),b?wa.animate(_,"top",a,s):(_.css("top",a),s(a)))}function s(a){a===c&&(a=_.position().top),U.scrollTop(0),ba=a||0;var b=0===ba,e=ba==aa,f=a/aa,g=-f*(W-T);(xa!=b||za!=e)&&(xa=b,za=e,d.trigger("jsp-arrow-change",[xa,za,ya,Aa])),v(b,e),R.css("top",g),d.trigger("jsp-scroll-y",[-g,b,e]).trigger("scroll")}function t(a,b){$&&(0>a?a=0:a>da&&(a=da),b===c&&(b=Q.animateScroll),b?wa.animate(ca,"left",a,u):(ca.css("left",a),u(a)))}function u(a){a===c&&(a=ca.position().left),U.scrollTop(0),ea=a||0;var b=0===ea,e=ea==da,f=a/da,g=-f*(V-S);(ya!=b||Aa!=e)&&(ya=b,Aa=e,d.trigger("jsp-arrow-change",[xa,za,ya,Aa])),w(b,e),R.css("left",g),d.trigger("jsp-scroll-x",[-g,b,e]).trigger("scroll")}function v(a,b){Q.showArrows&&(ka[a?"addClass":"removeClass"]("jspDisabled"),la[b?"addClass":"removeClass"]("jspDisabled"))}function w(a,b){Q.showArrows&&(qa[a?"addClass":"removeClass"]("jspDisabled"),ra[b?"addClass":"removeClass"]("jspDisabled"))}function x(a,b){var c=a/(W-T);r(c*aa,b)}function y(a,b){var c=a/(V-S);t(c*da,b)}function z(b,c,d){var e,f,g,h,i,j,k=0,l=0;try{e=a(b)}catch(m){return}for(console.log("e:"+e),f=e.outerHeight(),console.log("eleHeight:"+f),g=e.outerWidth(),U.scrollTop(0),U.scrollLeft(0);!e.is(".jspPane");)if(k+=e.offset().top,l+=e.offset().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;h=B(),i=h+T,h>k||c?j=k-Q.horizontalGutter:k+f>i&&(j=k-T+f+Q.horizontalGutter),isNaN(j)||x(j,d)}function A(){return-R.position().left}function B(){return-R.position().top}function C(){var a=W-T;return a>20&&a-B()<10}function D(){var a=V-S;return a>20&&a-A()<10}function E(){U.unbind(Ca).bind(Ca,function(a,b,c,d){ea||(ea=0),ba||(ba=0);var e=ea,f=ba,g=a.deltaFactor||Q.mouseWheelSpeed;return wa.scrollBy(c*g,-d*g,!1),e==ea&&f==ba})}function F(){U.unbind(Ca)}function G(){return!1}function H(){R.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){z(a.target,!1)})}function I(){R.find(":input,a").unbind("focus.jsp")}function J(){function b(){var a=ea,b=ba;switch(c){case 40:wa.scrollByY(Q.keyboardSpeed,!1);break;case 38:wa.scrollByY(-Q.keyboardSpeed,!1);break;case 34:case 32:wa.scrollByY(T*Q.scrollPagePercent,!1);break;case 33:wa.scrollByY(-T*Q.scrollPagePercent,!1);break;case 39:wa.scrollByX(Q.keyboardSpeed,!1);break;case 37:wa.scrollByX(-Q.keyboardSpeed,!1)}return e=a!=ea||b!=ba}var c,e,f=[];$&&f.push(ma[0]),Z&&f.push(fa[0]),R.focus(function(){d.focus()}),d.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(d){if(d.target===this||f.length&&a(d.target).closest(f).length){var g=ea,h=ba;switch(d.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=d.keyCode,b();break;case 35:x(W-T),c=null;break;case 36:x(0),c=null}return e=d.keyCode==c&&g!=ea||h!=ba,!e}}).bind("keypress.jsp",function(a){return a.keyCode==c&&b(),!e}),Q.hideFocus?(d.css("outline","none"),"hideFocus"in U[0]&&d.attr("hideFocus",!0)):(d.css("outline",""),"hideFocus"in U[0]&&d.attr("hideFocus",!1))}function K(){d.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function L(){if(location.hash&&location.hash.length>1){var b,c,d=escape(location.hash.substr(1));try{b=a("#"+d+', a[name="'+d+'"]')}catch(e){return}b.length&&R.find(d)&&(0===U.scrollTop()?c=setInterval(function(){U.scrollTop()>0&&(z(b,!0),a(document).scrollTop(U.position().top),clearInterval(c))},50):(z(b,!0),a(document).scrollTop(U.position().top)))}}function M(){a(document.body).data("jspHijack")||(a(document.body).data("jspHijack",!0),a(document.body).delegate("a[href*=#]","click",function(c){var d,e,f,g,h,i,j=this.href.substr(0,this.href.indexOf("#")),k=location.href;if(-1!==location.href.indexOf("#")&&(k=location.href.substr(0,location.href.indexOf("#"))),j===k){d=escape(this.href.substr(this.href.indexOf("#")+1));try{e=a("#"+d+', a[name="'+d+'"]')}catch(l){return}e.length&&(f=e.closest(".jspScrollable"),g=f.data("jsp"),g.scrollToElement(e,!0),f[0].scrollIntoView&&(h=a(b).scrollTop(),i=e.offset().top,(h>i||i>h+a(b).height())&&f[0].scrollIntoView()),c.preventDefault())}}))}function N(){var a,b,c,d,e,f=!1;U.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=A(),b=B(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=ea,j=ba;return wa.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i==ea&&j==ba}}).bind("touchend.jsp",function(a){f=!1}).bind("click.jsp-touchclick",function(a){return e?(e=!1,!1):void 0})}function O(a){var b=B(),c=A();d.removeClass("jspScrollable").unbind(".jsp"),d.replaceWith(Ba.append(R.children())),Ba.scrollTop(b),Ba.scrollLeft(c),sa&&clearInterval(sa)}function P(b){console.log("in reinitialize n adding dynamically"),b=a.extend({},Q,b),f(b)}var Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa=this,xa=!0,ya=!0,za=!1,Aa=!1,Ba=d.clone(!1,!1).empty(),Ca=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===d.css("box-sizing")?(ta=0,ua=0):(ta=d.css("paddingTop")+" "+d.css("paddingRight")+" "+d.css("paddingBottom")+" "+d.css("paddingLeft"),ua=(parseInt(d.css("paddingLeft"),10)||0)+(parseInt(d.css("paddingRight"),10)||0)),a.extend(wa,{reinitialise:function(b){b=a.extend({},Q,b),f(b)},scrollToElement:function(a,b,c){z(a,b,c)},scrollTo:function(a,b,c){y(a,c),x(b,c)},scrollToX:function(a,b){y(a,b)},scrollToY:function(a,b){x(a,b)},scrollToPercentX:function(a,b){y(a*(V-S),b)},scrollToPercentY:function(a,b){x(a*(W-T),b)},scrollBy:function(a,b,c){wa.scrollByX(a,c),wa.scrollByY(b,c)},scrollByX:function(a,b){var c=A()+Math[0>a?"floor":"ceil"](a),d=c/(V-S);t(d*da,b)},scrollByY:function(a,b){var c=B()+Math[0>a?"floor":"ceil"](a),d=c/(W-T);r(d*aa,b)},positionDragX:function(a,b){t(a,b)},positionDragY:function(a,b){r(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:Q.animateDuration,easing:Q.animateEase,queue:!1,step:d})},getContentPositionX:function(){return A()},getContentPositionY:function(){return B()},getContentWidth:function(){return V},getContentHeight:function(){return W},getPercentScrolledX:function(){return A()/(V-S)},getPercentScrolledY:function(){return B()/(W-T)},getIsScrollableH:function(){return $},getIsScrollableV:function(){return Z},getContentPane:function(){return R},scrollToBottom:function(a){console.log("scrollTobottom Called:"+aa),r(aa,a)},hijackInternalLinks:a.noop,destroy:function(){O()},reIntialiseOnAddingDynamicContent:function(){P()}}),f(e)}return d=a.extend({},a.fn.jScrollPane.defaults,d),a.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){d[this]=d[this]||d.speed}),this.each(function(){var b=a(this),c=b.data("jsp");c?c.reinitialise(d):(a("script",b).filter('[type="text/javascript"],:not([type])').remove(),c=new e(b,d),b.data("jsp",c))})},a.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!1,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!0,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:5,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!0,keyboardSpeed:0,initialDelay:300,speed:40,scrollPagePercent:.8}},this),function(){angular.module("ngJScrollPane",[]),angular.module("ngJScrollPane").directive("scrollPane",["$timeout",function(a){return{restrict:"A",transclude:!0,template:'<div class="scroll-pane"><div id="transclude" ng-transclude></div></div>',link:function(a,b,c){var d;return d={},c.scrollConfig&&(d=a.$eval(c.scrollConfig)),a.$on("initialize-pane",function(b,c){return console.log("initialize-pane:"+c),jQuery("#"+c).jScrollPane(d),a.pane=jQuery("#"+c).data("jsp")}),a.$on("reinit-pane",function(b,d){d===c.id&&a.pane&&(console.log("Reinit pane "+d),settings={verticalDragMinHeight:10},a.pane.reinitialise(settings),a.pane.scrollToBottom(!0))})},replace:!0}}])}.call(this);