<!DOCTYPE html>

<style type="text/css">
    .ng-pageslide{
        background: #eee;
    }
    .ng-travel{
        background: #bbbbbb;
    }
</style>
<div ng-controller="routesController">
    <div style="overflow: visible" ng-controller="sarthiController" >

        <div>

            <pageslide ps-open="isTravelPanelOpen" ps-size="400px" ps-side="left" ps-class="ng-travel">
                <!--<div ng-hide="loader">-->
                <!--<img src="images/loading.gif" class="img-responsive" style="width: 100%"/>-->
                <!--</div>-->
                <div class="panel panel-default" style="height: 100vh"  ng-click="closeOtherPanels(1)">

                    <div class="panel-body">
                        <div ng-hide="isTravelPanelDataHidden" class="travel-pageslide">
                            <p>
                            <div class="panel panel-primary">
                                <div class="panel-heading text-center">
                                    <h3>Trip Overview</h3>
                                </div>
                            </div>
                            <!--<div class="page-header text-center">-->
                            <!--<h1><small>Trip Overview</small></h1>-->
                            <!--</div>-->

                            <div scroll-pane scroll-config="paneConfig" id="travelPanel" style="width:380px;height:100vh">
                                <div id="transcludeTravelPanel">
                                    <div class="panel-travel" ng-repeat="leg in legs" collapse="isTripPanelSetCollapsed" post-repeat>
                                        <div class="panel panel-default">
                                            <div class="panel-body">
                                                {{getSourceCityName($index)}}
                                            </div>
                                        </div>
                                        <div ng-repeat="segment in leg.defaultRoute.segments">
                                            <div ng-if="segment.isMajor != 0" ng-href='#' ng-click="openTravelModesPanel(leg, $event, $parent.$parent.$index)">
                                                <div ng-if="segment.startCabTrip != undefined && segment.startCabTrip == 1" ng-click="openModeDetailsPanel(segment, route, $event,'cabOperator')">
                                                    <div ng-repeat="cabDetail in segment.CabDetails">
                                                        <div ng-if="cabDetail.isFinal != undefined && cabDetail.isFinal == 1" class="panel panel-info">
                                                            <div class="panel-heading">
                                                                <div class="row">
                                                                    <div class="col-xs-4">
                                                                        {{cabDetail.SegmentType}}
                                                                    </div>
                                                                    <div ng-repeat="cabOperator in cabDetail.OperatorPrices">
                                                                        <div ng-if="cabOperator.isFinal != undefined && cabOperator.isFinal == 1">
                                                                            <div class="col-xs-4">
                                                                                {{cabOperator.Operator}}
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                {{cabOperator.ActualCabPrice}}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div ng-if="isSegmentShown(segment,leg)" class="panel panel-default travel-panel {{getRouteClass(segment)}}">
                                                    <div class="panel-body travel-panel-body">
                                                        <div class="col-xs-3">
                                                            <img ng-src="images/{{getModeIcon(segment)}}.png" style="margin:auto; font-size: 2em; margin-top: 30%" class="img-responsive">
                                                            <!--<i class="glyphicon {{getModeIcon(segment)}} glyphicon-large" style="font-size: 2em; margin-top: 30%"></i>-->
                                                        </div>
                                                        <div class="col-xs-3">
                                                            <div class="row">
                                                                {{getDateFormatted(segment) | date:'mediumDate'}}
                                                            </div>
                                                            <div class="row">
                                                                {{getDateFormatted(segment) | date:'EEE'}}
                                                            </div>
                                                            <div class="row">
                                                                {{getDuration(segment)}}
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-3">
                                                            {{getDateFormatted(segment) | date:'shortTime'}}
                                                        </div>
                                                        <div class="col-xs-3">
                                                            {{getPrice(segment) | currency:"&#8377;"}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div ng-if="segment.majorIndex != leg.defaultRoute.majorCount && isViaShown(segment)">
                                                    <div class="panel panel-default">
                                                        <div class="panel-body stop-panel-body">
                                                            VIA {{getStopName($index, leg.defaultRoute)}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div ng-if="$last">
                                            <div class="panel panel-default">
                                                <div class="panel-body">
                                                    {{getDestinationCityName($index)}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default" ng-click="showOtherTrip()">
                                        <div class="panel-heading">
                                            We suggest you check out multi-city taxi for this trip!
                                        </div>
                                    </div>

                                </div>
                            </div>
                            </p>
                        </div>
                    </div>
                </div>

            </pageslide>
            <pageslide ps-open="isTravelModesPanelOpen" ps-side="left" ps-size="350px">
                <div class="panel panel-default" style="height: 100vh"  ng-click="closeOtherPanels(2)">

                    <div class="panel-body">
                        <div class="page-header text-center">
                            <h1><small>{{getSourceCityFromLeg()}} - {{getDestinationCityFromLeg()}}</small></h1>
                        </div>

                        <div scroll-pane scroll-config="paneConfig" id="travelModesPanel" style="width:330px;height:100vh">
                            <div id="transcludeTravelModesPanel">
                                <div class="panel-travelMode" ng-repeat="route in routes" post-repeat>
                                    <div ng-repeat="segment in route.segments">
                                        <div ng-if="segment.isMajor != 0">
                                            <div class="panel panel-default" ng-href='#' ng-click="openModeDetailsPanel(segment,route, $event,'cabTimings')">
                                                <div class="panel-body">
                                                    <div class="col-xs-2">
                                                        <img ng-src="images/{{getModeIcon(segment)}}.png" style="margin:auto; font-size: 2em; margin-top: 30%" class="img-responsive">
                                                    </div>
                                                    <div class="col-xs-2">
                                                        <div class="row">
                                                            {{getDateFormatted(segment) | date:'mediumDate'}}
                                                        </div>
                                                        <div class="row">
                                                            {{getDateFormatted(segment) | date:'EEE'}}
                                                        </div>
                                                        <div class="row">
                                                            {{getDuration(segment)}}
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-2">
                                                        {{getDateFormatted(segment) | date:'shortTime'}}
                                                    </div>
                                                    <div class="col-xs-2">
                                                        {{getPrice(segment) | currency:"&#8377;"}}
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-if="segment.majorIndex != route.majorCount">
                                                <div class="panel panel-default">
                                                    <div class="panel-body">
                                                        VIA {{getStopName($index, route)}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </pageslide>
            <pageslide ps-open="isModeDetailsPanelOpen" ps-side="left" ps-size="300px">
                <div class="panel panel-default" style="height: 100vh">
                    <div class="panel-body">
                        <div ng-if="isTrainClicked" ng-repeat="train in trains">
                            <div ng-if="train.isRecommended != 0" class="panel {{getPanelClass(train)}}">
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col-xs-8">
                                            {{train.TrainName}}
                                        </div>
                                        <div class="col-xs-4">
                                            {{train.TrainNo}}
                                        </div>
                                    </div>
                                    <div class="row text-center">
                                        {{train.OriginStationCode}} - {{train.DestStationCode}}
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-xs-10">
                                            <div class="row text-center">
                                                <div class="col-xs-5">
                                                    <div class="row">
                                                        {{train.OriginDepartureTime}}
                                                    </div>
                                                </div>
                                                <div class="col-xs-5">
                                                    <div class="row">
                                                        {{train.DestArrivalTime}}
                                                    </div>
                                                    <div class="row">
                                                        <small>{{getNthDay(train)}}</small>
                                                    </div>
                                                </div>
                                                <div class="col-xs-2">
                                                    {{train.fare | currency:"&#8377;"}}
                                                </div>
                                            </div>
                                            <div class="row" style="padding-top: 10%">
                                                <div class="col-xs-8">
                                                    <button datepicker-popup="dd-MMMM-yyyy" ng-model="vehicleDate[$index].dt"
                                                            is-open="vehicleDate[$index].opened" min-date="vehicleDate[$index].minDate"
                                                            max-date="vehicleDate[$index].maxDate"
                                                            datepicker-options="dateOptions" ng-required="true"
                                                            close-text="Close" ng-click="open($event,$index)" ng-disabled="vehicleDate[$index].disabled" date-disabled="disabled(date, mode, train)">
                                                        <div class="row">
                                                            <div class="col-xs-2 h5">
                                                                <i class="glyphicon glyphicon-calendar"></i>
                                                            </div>
                                                            <div class="col-xs-2 h5">{{(vehicleDate[$index].dt | date:'dd') || 'Select'}}
                                                            </div>
                                                            <div class="col-xs-4">
                                                                <div class="row">
                                                                    <div class="col-xs-2 month">{{vehicleDate[$index].dt |
                                                                        date:'MMM'}}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-2 day">{{vehicleDate[$index].dt |
                                                                        date:'EEE'}}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                                <div class="col-xs-4">
                                                    <div class="btn {{getAddButtonClass(train)}}" ng-click="addToTrip(train,$index,$event)">{{getAddButtonText(train)}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-if="isFlightClicked" ng-repeat="flight in flights">
                            <div ng-if="flight.isRecommended != 0" class="panel {{getPanelClass(flight)}}">
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col-xs-8">
                                            {{flight.Operator}}
                                        </div>
                                        <div class="col-xs-4">
                                            {{flight.FlightNumber}}
                                        </div>
                                    </div>
                                    <div class="row text-center">
                                        {{flight.OriginAirportCode}} - {{flight.DestinationAirportCode}}
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-xs-10">
                                            <div class="row text-center">
                                                <div class="col-xs-5">
                                                    <div class="row">
                                                        {{flight.OriginDepartureTime}}
                                                    </div>
                                                </div>
                                                <div class="col-xs-5">
                                                    <div class="row">
                                                        {{flight.DestArrivalTime}}
                                                    </div>
                                                </div>
                                                <!--<div class="col-xs-2">-->
                                                <!--{{flight.fare | currency:"&#8377;"}}-->
                                                <!--</div>-->
                                            </div>
                                            <div class="row" style="padding-top: 10%">
                                                <div class="col-xs-8">
                                                    <button datepicker-popup="dd-MMMM-yyyy" ng-model="vehicleDate[$index].dt"
                                                            is-open="vehicleDate[$index].opened" min-date="vehicleDate[$index].minDate"
                                                            max-date="vehicleDate[$index].maxDate"
                                                            datepicker-options="dateOptions" ng-required="true"
                                                            close-text="Close" ng-click="open($event,$index)" ng-disabled="vehicleDate[$index].disabled" date-disabled="disabled(date, mode, flight)">
                                                        <div class="row">
                                                            <div class="col-xs-2 h5">
                                                                <i class="glyphicon glyphicon-calendar"></i>
                                                            </div>
                                                            <div class="col-xs-2 h5">{{(vehicleDate[$index].dt | date:'dd') || 'Select'}}
                                                            </div>
                                                            <div class="col-xs-4">
                                                                <div class="row">
                                                                    <div class="col-xs-2 month">{{vehicleDate[$index].dt |
                                                                        date:'MMM'}}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-2 day">{{vehicleDate[$index].dt |
                                                                        date:'EEE'}}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                                <div class="col-xs-4">
                                                    <div class="btn {{getAddButtonClass(flight)}}" ng-click="addToTrip(flight,$index,$event)">{{getAddButtonText(flight)}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div  ng-if="isCabClicked">
                            <div class = "panel panel-default">
                            <div class="panel-body">
                                <div class="row">
                            <button datepicker-popup="dd-MMMM-yyyy" ng-model="cabDate.dt"
                            is-open="cabDate.opened" min-date="cabDate.minDate"
                            max-date="cabDate.maxDate"
                            datepicker-options="dateOptions" ng-required="true"
                            close-text="Close" ng-click="openCabDate($event)" ng-disabled="cabDate.disabled">
                                <div class="row">
                                    <div class="col-xs-2 h5">
                                        <i class="glyphicon glyphicon-calendar"></i>
                                    </div>
                                    <div class="col-xs-2 h5">{{(cabDate.dt | date:'dd') || 'Select'}}
                                    </div>
                                    <div class="col-xs-4">
                                        <div class="row">
                                            <div class="col-xs-2 month">{{cabDate.dt |
                                                date:'MMM'}}
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-2 day">{{cabDate.dt |
                                                date:'EEE'}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </button>
                                </div>
                                <div class="row">
                                <input ng-model="value"  type="text" id="cabTimeSlider" slider options="options" />
                                {{value}}
                                </div>
                                <div class="row">
                                    <div class="btn {{getAddButtonClass(flight)}} btn-block" ng-click="addToTrip(flight,$index,$event)">{{getAddButtonText(flight)}}</div>
                                </div>
                            </div>
                            </div>
                        </div>
                        <div ng-if="isCabOperatorClicked">
                            <accordion close-others="true">
                                <accordion-group ng-repeat="cabDetail in cabDetails" is-open="cabDetailToggle[$index].open">
                                    <accordion-heading>
                                        <div class="{{getAccordionHeadingClass(cabDetail)}}">
                                            {{cabDetail.SegmentType}}<i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': cabDetailToggle[$index].open, 'glyphicon-chevron-right': !cabDetailToggle[$index].open}"></i>
                                        </div>
                                    </accordion-heading>
                                    <div ng-repeat="operator in cabDetail.OperatorPrices" class="row {{getCabOperatorClass(operator)}}">
                                        <div class="panel panel-default">
                                            <div class="panel-body">
                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        {{operator.Operator}}
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <div class="row">
                                                            {{operator.ActualCabPrice | currency:"&#8377;"}}
                                                        </div>
                                                        <div class="row">
                                                            <div style="margin-top: 10%">
                                                                <div class="btn {{getAddButtonClass(operator)}} btn-block" ng-click="changeCabOperator(cabDetail,operator,$event)">{{getAddButtonText(operator)}}</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </accordion-group>
                            </accordion>
                        </div>
                    </div>
                </div>
            </pageslide>
        </div>
        <div class="col-xs-12">
            <div class="budget col-xs-2">
                <div ng-if="isBudgetPanelOpen" class="panel panel-default">
                        <ul class="list-group">
                            <li class="list-group-item">
                                <div class="row">
                                    <div class="col-xs-7">{{totalBudgetText}}</div>
                                    <div class="col-xs-5">{{totalBudget | currency:"&#8377;"}}</div>
                                </div>
                            </li>
                            <li class="list-group-item">
                                <div class="row">
                                    <div class="col-xs-7">{{travelBudgetText}}</div>
                                    <div class="col-xs-5">{{travelBudget | currency:"&#8377;"}}</div>
                                </div>
                            </li>
                            <li class="list-group-item">
                                <div class="row">
                                    <div class="col-xs-7">{{minorBudgetText}}</div>
                                    <div class="col-xs-5">{{minorBudget | currency:"&#8377;"}}</div>
                                </div>
                            </li>
                        </ul>
                </div>
                <div ng-controller="balaramaController">
                    <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>
                </div>
            </div>
            <div id="map-canvas" ng-controller="sanjayaController"></div>
        </div>
    </div>
</div>
